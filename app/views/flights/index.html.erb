<div class= "header">
  <h3> Flight Searcher </h3>
  <p> <%= @regdate %> </p>

<%= form_tag('/flights', method: 'get') do %>
  <% if params[:flight] %>
    <%= select(:flight,
               :from_airport,
               @airport_options,
               :selected => params[:flight][:from_airport]) %>
    <%= select(:flight,
               :to_airport,
               @airport_options,
               :selected => params[:flight][:to_airport]) %>
    <br>
    <br>
    <br>
    <%= date_select(:flight,
                    :start_date,
                    start_year: Time.now.year,
                    :selected => Time.now)%>
    <br>
    <br>
    <br>
    <%= date_select(:flight,
                    :end_date,
                    start_year: Time.now.year
                      )%>
  <% else %>
    <%= select(:flight,
               :from_airport,
               @airport_options) %>
    <%= select(:flight,
               :to_airport,
               @airport_options) %>
   <br>
   <br>
   <br>
   <%= date_select(:flight,
                   :start_date,
                   start_year: Time.now.year,
                   default: @the_date,
                   :include_blank=> @the_date.nil? ) %>
   <br>
   <br>
   <br>
   <%= date_select(:flight,
                   :end_date,
                   start_year: Time.now.year,
                   default: @the_date,
                   :include_blank=> @the_date.nil? ) %>
  <% end %>
  <br>
  <br>
  <%= submit_tag 'submit' %>
<% end %>

<p><%= params.inspect %></p>

<div class="results" >
  <table>
    <tr>
      <th>Flight ID</th>
      <th>Departing Airport</th>
      <th>Arriving Airport</th>
      <th>Flight Duration(hours)</th>
      <th> Departure Date </th>
    </tr>
    <% @flights.each do |flight| %>
      <tr>
        <th> <%= flight.id %> </th>
        <th> <%= flight.from_airport.code %> </th>
        <th> <%= flight.to_airport.code %> </th>
        <th> <%= flight.duration %> </th>
        <th> <%= flight.departure %> </th>
      </tr>
    <% end %>
  </table>
</div>
